{"ast":null,"code":"var _jsxFileName = \"/Users/hadrien/Desktop/Projets OPENCLASSROOM/P7_vaison_hadrien/hadrien_P7/frontend/src/pages/postPage/PostPage.jsx\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState, useContext } from \"react\";\nimport axios from \"axios\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport styled from \"styled-components\";\nimport { Link } from \"react-router-dom\";\nimport colors from \"../../utils/style/colors\";\nimport { FormWrapper, Label, FileInput, CancelImg, StyledHr, TextArea, Button } from \"../../components/postform/PostForm\";\nimport { PostText } from \"../../components/post/Post\";\nimport PermMediaIcon from \"@mui/icons-material/PermMedia\";\nimport BackspaceIcon from \"@mui/icons-material/Backspace\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst PostFormContainer = styled.form`\n  display: flex;\n  flex-direction: column;\n  row-gap: 15px;\n  width: 90%;\n  max-width: 700px;\n  padding:15px;\n  margin: 20px auto 50px;\n  background-color: whitesmoke;\n  border-radius: 10px;\n  border:1px solid ${colors.primary};\n  box-shadow: 3px 5px 5px ${colors.secondary};\n`;\n_c = PostFormContainer;\nconst PostFormImgContainer = styled.div`\n  display: flex;\n  justify-content: center;\n  height: 200px;\n  width:70%;\n  padding: 0 20px 10px 20px;\n  margin: 0 auto;\n  position: relative;\n`;\n_c2 = PostFormImgContainer;\nconst PostFileImg = styled.img`\n  border-radius: 10px;\n  height:auto;\n  width: 70%;\n  object-fit: cover;\n`;\n_c3 = PostFileImg;\nconst Title = styled.h2`\n  display: flex;\n  width: 100%;\n  justify-content: center;\n  margin: 50px 0 50px;\n  color: ${colors.tertiary};\n`;\n_c4 = Title;\nconst ReturnIcon = styled(Link)`\n  display: flex;\n  align-items: center;\n  column-gap: 25px;\n  font-size: 25px;\n  text-decoration:underline;\n  text-decoration-color:${colors.primary};\n  color: ${colors.tertiary};\n  margin: 25px 0 0 25px;\n  &:hover {\n    cursor: pointer;\n    color: ${colors.primary};\n  }\n`; //Function\n\n_c5 = ReturnIcon;\nexport default function PostPage() {\n  _s();\n\n  //Navigation\n  const navigate = useNavigate(); //Params & user context\n\n  const {\n    id\n  } = useParams();\n  const {\n    user\n  } = useContext(AuthContext); //States\n\n  const [message, setMessage] = useState(\"\");\n  const [postFile, setPostFile] = useState(\"\");\n  const [file, setFile] = useState(\"\");\n  const [post, setPost] = useState({}); //Get a post\n\n  useEffect(() => {\n    const getPost = async () => {\n      const res = await axios.get(`http://localhost:3002/api/posts/${id}`, {\n        headers: {\n          Authorization: user.token\n        }\n      });\n      setPost(res.data);\n      setPostFile(res.data.image);\n      setMessage(res.data.message);\n    };\n\n    getPost();\n  }, [id, user]); //Update post\n\n  const handleUpdate = async e => {\n    const newFile = file ? file : \"\";\n    e.preventDefault();\n    const formData = new FormData();\n    formData.append(\"userId\", user.currentUser.userId);\n    formData.append(\"image\", newFile);\n    formData.append(\"message\", message);\n    await axios.put(`http://localhost:3002/api/posts/${id}`, formData, {\n      headers: {\n        Authorization: user.token\n      }\n    });\n    navigate(\"/\");\n  };\n\n  return /*#__PURE__*/_jsxDEV(FormWrapper, {\n    children: [/*#__PURE__*/_jsxDEV(ReturnIcon, {\n      to: \"/\",\n      children: \"Retour\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Title, {\n      children: \"Modifiez votre Post :\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(PostFormContainer, {\n      onSubmit: handleUpdate,\n      children: [postFile ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(PostText, {\n          children: \"Image actuelle\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(PostFormImgContainer, {\n          children: /*#__PURE__*/_jsxDEV(PostFileImg, {\n            src: postFile\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true) : \"\", file && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(PostText, {\n          children: \"Nouvelle image\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(PostFormImgContainer, {\n          children: [/*#__PURE__*/_jsxDEV(PostFileImg, {\n            src: URL.createObjectURL(file),\n            alt: \"post_image\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(CancelImg, {\n            onClick: () => {\n              setFile(\"\");\n              setPostFile(postFile);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true), /*#__PURE__*/_jsxDEV(Label, {\n        htmlFor: \"file\",\n        children: [\"Modifier image :\", /*#__PURE__*/_jsxDEV(PermMediaIcon, {\n          htmlColor: `${colors.primary}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(FileInput, {\n          type: \"file\",\n          id: \"file\",\n          accept: \".png,.jpg,.jpeg\",\n          onChange: e => setFile(e.target.files[0])\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Label, {\n        htmlFor: \"message\",\n        children: \"Modifier message :\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(TextArea, {\n        name: \"message\",\n        value: message,\n        onChange: e => setMessage(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        children: \"VALIDER\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 127,\n    columnNumber: 5\n  }, this);\n}\n\n_s(PostPage, \"CwTBrVLAgtgYyyEg8ZiGhdqMzhs=\", false, function () {\n  return [useNavigate, useParams];\n});\n\n_c6 = PostPage;\n\nvar _c, _c2, _c3, _c4, _c5, _c6;\n\n$RefreshReg$(_c, \"PostFormContainer\");\n$RefreshReg$(_c2, \"PostFormImgContainer\");\n$RefreshReg$(_c3, \"PostFileImg\");\n$RefreshReg$(_c4, \"Title\");\n$RefreshReg$(_c5, \"ReturnIcon\");\n$RefreshReg$(_c6, \"PostPage\");","map":{"version":3,"names":["useEffect","useState","useContext","axios","AuthContext","styled","Link","colors","FormWrapper","Label","FileInput","CancelImg","StyledHr","TextArea","Button","PostText","PermMediaIcon","BackspaceIcon","useNavigate","useParams","PostFormContainer","form","primary","secondary","PostFormImgContainer","div","PostFileImg","img","Title","h2","tertiary","ReturnIcon","PostPage","navigate","id","user","message","setMessage","postFile","setPostFile","file","setFile","post","setPost","getPost","res","get","headers","Authorization","token","data","image","handleUpdate","e","newFile","preventDefault","formData","FormData","append","currentUser","userId","put","URL","createObjectURL","target","files","value"],"sources":["/Users/hadrien/Desktop/Projets OPENCLASSROOM/P7_vaison_hadrien/hadrien_P7/frontend/src/pages/postPage/PostPage.jsx"],"sourcesContent":["import { useEffect, useState, useContext } from \"react\";\nimport axios from \"axios\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport styled from \"styled-components\";\nimport { Link } from \"react-router-dom\";\n\nimport colors from \"../../utils/style/colors\";\nimport {\n  FormWrapper,\n  Label,\n  FileInput,\n  CancelImg,\n  StyledHr,\n  TextArea,\n  Button,\n} from \"../../components/postform/PostForm\";\nimport { PostText } from \"../../components/post/Post\";\nimport PermMediaIcon from \"@mui/icons-material/PermMedia\";\nimport BackspaceIcon from \"@mui/icons-material/Backspace\";\nimport { useNavigate, useParams } from \"react-router-dom\";\n\nconst PostFormContainer = styled.form`\n  display: flex;\n  flex-direction: column;\n  row-gap: 15px;\n  width: 90%;\n  max-width: 700px;\n  padding:15px;\n  margin: 20px auto 50px;\n  background-color: whitesmoke;\n  border-radius: 10px;\n  border:1px solid ${colors.primary};\n  box-shadow: 3px 5px 5px ${colors.secondary};\n`;\n\nconst PostFormImgContainer = styled.div`\n  display: flex;\n  justify-content: center;\n  height: 200px;\n  width:70%;\n  padding: 0 20px 10px 20px;\n  margin: 0 auto;\n  position: relative;\n`;\n\nconst PostFileImg = styled.img`\n  border-radius: 10px;\n  height:auto;\n  width: 70%;\n  object-fit: cover;\n`;\n\nconst Title = styled.h2`\n  display: flex;\n  width: 100%;\n  justify-content: center;\n  margin: 50px 0 50px;\n  color: ${colors.tertiary};\n`;\n\nconst ReturnIcon = styled(Link)`\n  display: flex;\n  align-items: center;\n  column-gap: 25px;\n  font-size: 25px;\n  text-decoration:underline;\n  text-decoration-color:${colors.primary};\n  color: ${colors.tertiary};\n  margin: 25px 0 0 25px;\n  &:hover {\n    cursor: pointer;\n    color: ${colors.primary};\n  }\n`;\n\n//Function\nexport default function PostPage() {\n  //Navigation\n  const navigate = useNavigate();\n  //Params & user context\n  const { id } = useParams();\n  const { user } = useContext(AuthContext);\n  //States\n  const [message, setMessage] = useState(\"\");\n  const [postFile, setPostFile] = useState(\"\");\n  const [file, setFile] = useState(\"\");\n  const [post, setPost] = useState({});\n\n  //Get a post\n  useEffect(() => {\n    const getPost = async () => {\n      const res = await axios.get(\n        `http://localhost:3002/api/posts/${id}`,\n        {\n          headers: { Authorization: user.token },\n        }\n      );\n      setPost(res.data);\n      setPostFile(res.data.image);\n      setMessage(res.data.message);\n    };\n    getPost();\n  }, [id, user]);\n\n  //Update post\n  const handleUpdate = async (e) => {\n    const newFile = file ? file : \"\";\n    e.preventDefault();\n    const formData = new FormData();\n    formData.append(\"userId\", user.currentUser.userId);\n    formData.append(\"image\", newFile);\n    formData.append(\"message\", message);\n\n    await axios.put(\n      `http://localhost:3002/api/posts/${id}`,\n      formData,\n      {\n        headers: {\n          Authorization: user.token,\n        },\n      }\n    );\n    navigate(\"/\");\n  };\n\n  return (\n    <FormWrapper>\n      <ReturnIcon to=\"/\">\n        Retour\n      </ReturnIcon>\n      <Title>Modifiez votre Post :</Title>\n      <PostFormContainer onSubmit={handleUpdate}>\n        {postFile ? (\n          <>\n            <PostText>Image actuelle</PostText>\n            <PostFormImgContainer>\n              <PostFileImg src={postFile} />\n            </PostFormImgContainer>\n          </>\n        ) : (\n          \"\"\n        )}\n        {file && (\n          <>\n            <PostText>Nouvelle image</PostText>\n            <PostFormImgContainer>\n              <PostFileImg src={URL.createObjectURL(file)} alt=\"post_image\" />\n              <CancelImg\n                onClick={() => {\n                  setFile(\"\");\n                  setPostFile(postFile);\n                }}\n              />\n            </PostFormImgContainer>\n          </>\n        )}\n        <Label htmlFor=\"file\">\n          Modifier image :\n          <PermMediaIcon htmlColor={`${colors.primary}`} />\n          <FileInput\n            type=\"file\"\n            id=\"file\"\n            accept=\".png,.jpg,.jpeg\"\n            onChange={(e) => setFile(e.target.files[0])}\n          />\n        </Label>\n        <Label htmlFor=\"message\">Modifier message :</Label>\n        <TextArea\n          name=\"message\"\n          value={message}\n          onChange={(e) => setMessage(e.target.value)}\n        ></TextArea>\n        <Button>VALIDER</Button>\n      </PostFormContainer>\n    </FormWrapper>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}