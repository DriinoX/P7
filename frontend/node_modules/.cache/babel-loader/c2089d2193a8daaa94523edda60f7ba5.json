{"ast":null,"code":"var _jsxFileName = \"/Users/hadrien/Desktop/Projets OPENCLASSROOM/P7_vaison_hadrien/hadrien_P7/frontend/src/pages/postPage/PostPage.jsx\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState, useContext } from \"react\";\nimport axios from \"axios\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport styled from \"styled-components\";\nimport { Link } from \"react-router-dom\";\nimport colors from \"../../utils/style/colors\";\nimport { FormWrapper, PostFormContainer, Label, FileInput, PostFormImgContainer, PostFileImg, CancelImg, StyledHr, TextArea, Button } from \"../../components/postform/PostForm\";\nimport { PostText } from \"../../components/post/Post\";\nimport PermMediaIcon from \"@mui/icons-material/PermMedia\";\nimport BackspaceIcon from \"@mui/icons-material/Backspace\";\nimport { useNavigate, useParams } from \"react-router-dom\"; //Styled components\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Title = styled.h2`\n  display: flex;\n  width: 100%;\n  justify-content: center;\n  margin: 50px 0 50px;\n  color: ${colors.tertiary};\n  text-shadow: 8px 8px 20px ${colors.tertiary};\n`;\n_c = Title;\nconst ReturnIcon = styled(Link)`\n  display: flex;\n  align-items: center;\n  column-gap: 25px;\n  font-size: 25px;\n  color: ${colors.tertiary};\n  margin: 25px 0 0 25px;\n  &:hover {\n    cursor: pointer;\n    color: ${colors.primary};\n  }\n`; //Function\n\n_c2 = ReturnIcon;\nexport default function PostPage() {\n  _s();\n\n  //Navigation\n  const navigate = useNavigate(); //Params & user context\n\n  const {\n    id\n  } = useParams();\n  const {\n    user\n  } = useContext(AuthContext); //States\n\n  const [message, setMessage] = useState(\"\");\n  const [postFile, setPostFile] = useState(\"\");\n  const [file, setFile] = useState(\"\");\n  const [post, setPost] = useState({}); //Get a post\n\n  useEffect(() => {\n    const getPost = async () => {\n      const res = await axios.get(`${process.env.REACT_APP_API_URL}/api/posts/${id}`, {\n        headers: {\n          Authorization: user.token\n        }\n      });\n      setPost(res.data);\n      setPostFile(res.data.image);\n      setMessage(res.data.message);\n    };\n\n    getPost();\n  }, [id, user]); //Update post\n\n  const handleUpdate = async e => {\n    const newFile = file ? file : \"\";\n    e.preventDefault();\n    const formData = new FormData();\n    formData.append(\"userId\", user.currentUser.userId);\n    formData.append(\"image\", newFile);\n    formData.append(\"message\", message);\n    await axios.put(`${process.env.REACT_APP_API_URL}/api/posts/${id}`, formData, {\n      headers: {\n        Authorization: user.token\n      }\n    });\n    navigate(\"/\");\n  };\n\n  return /*#__PURE__*/_jsxDEV(FormWrapper, {\n    children: [/*#__PURE__*/_jsxDEV(ReturnIcon, {\n      to: \"/\",\n      children: [/*#__PURE__*/_jsxDEV(BackspaceIcon, {\n        style: {\n          scale: \"2\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this), \"Retour\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Title, {\n      children: \"Modifiez votre Post :\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(PostFormContainer, {\n      onSubmit: handleUpdate,\n      children: [file && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(PostText, {\n          children: \"Nouvelle image\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(PostFormImgContainer, {\n          children: [/*#__PURE__*/_jsxDEV(PostFileImg, {\n            src: URL.createObjectURL(file),\n            alt: \"post_image\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(CancelImg, {\n            onClick: () => {\n              setFile(\"\");\n              setPostFile(postFile);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true), /*#__PURE__*/_jsxDEV(StyledHr, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 9\n      }, this), postFile ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(PostText, {\n          children: \"Ancienne image\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(PostFormImgContainer, {\n          children: /*#__PURE__*/_jsxDEV(PostFileImg, {\n            src: postFile\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true) : \"\", /*#__PURE__*/_jsxDEV(Label, {\n        htmlFor: \"file\",\n        children: [\"Modifier image :\", /*#__PURE__*/_jsxDEV(PermMediaIcon, {\n          htmlColor: `${colors.primary}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(FileInput, {\n          type: \"file\",\n          id: \"file\",\n          accept: \".png,.jpg,.jpeg\",\n          onChange: e => setFile(e.target.files[0])\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Label, {\n        htmlFor: \"message\",\n        children: \"Modifier message :\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(TextArea, {\n        name: \"message\",\n        value: message,\n        onChange: e => setMessage(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        children: \"VALIDER\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 5\n  }, this);\n}\n\n_s(PostPage, \"CwTBrVLAgtgYyyEg8ZiGhdqMzhs=\", false, function () {\n  return [useNavigate, useParams];\n});\n\n_c3 = PostPage;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"Title\");\n$RefreshReg$(_c2, \"ReturnIcon\");\n$RefreshReg$(_c3, \"PostPage\");","map":{"version":3,"names":["useEffect","useState","useContext","axios","AuthContext","styled","Link","colors","FormWrapper","PostFormContainer","Label","FileInput","PostFormImgContainer","PostFileImg","CancelImg","StyledHr","TextArea","Button","PostText","PermMediaIcon","BackspaceIcon","useNavigate","useParams","Title","h2","tertiary","ReturnIcon","primary","PostPage","navigate","id","user","message","setMessage","postFile","setPostFile","file","setFile","post","setPost","getPost","res","get","process","env","REACT_APP_API_URL","headers","Authorization","token","data","image","handleUpdate","e","newFile","preventDefault","formData","FormData","append","currentUser","userId","put","scale","URL","createObjectURL","target","files","value"],"sources":["/Users/hadrien/Desktop/Projets OPENCLASSROOM/P7_vaison_hadrien/hadrien_P7/frontend/src/pages/postPage/PostPage.jsx"],"sourcesContent":["import { useEffect, useState, useContext } from \"react\";\nimport axios from \"axios\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport styled from \"styled-components\";\nimport { Link } from \"react-router-dom\";\n\nimport colors from \"../../utils/style/colors\";\nimport {\n  FormWrapper,\n  PostFormContainer,\n  Label,\n  FileInput,\n  PostFormImgContainer,\n  PostFileImg,\n  CancelImg,\n  StyledHr,\n  TextArea,\n  Button,\n} from \"../../components/postform/PostForm\";\nimport { PostText } from \"../../components/post/Post\";\nimport PermMediaIcon from \"@mui/icons-material/PermMedia\";\nimport BackspaceIcon from \"@mui/icons-material/Backspace\";\nimport { useNavigate, useParams } from \"react-router-dom\";\n\n//Styled components\nconst Title = styled.h2`\n  display: flex;\n  width: 100%;\n  justify-content: center;\n  margin: 50px 0 50px;\n  color: ${colors.tertiary};\n  text-shadow: 8px 8px 20px ${colors.tertiary};\n`;\n\nconst ReturnIcon = styled(Link)`\n  display: flex;\n  align-items: center;\n  column-gap: 25px;\n  font-size: 25px;\n  color: ${colors.tertiary};\n  margin: 25px 0 0 25px;\n  &:hover {\n    cursor: pointer;\n    color: ${colors.primary};\n  }\n`;\n\n//Function\nexport default function PostPage() {\n  //Navigation\n  const navigate = useNavigate();\n  //Params & user context\n  const { id } = useParams();\n  const { user } = useContext(AuthContext);\n  //States\n  const [message, setMessage] = useState(\"\");\n  const [postFile, setPostFile] = useState(\"\");\n  const [file, setFile] = useState(\"\");\n  const [post, setPost] = useState({});\n\n  //Get a post\n  useEffect(() => {\n    const getPost = async () => {\n      const res = await axios.get(\n        `${process.env.REACT_APP_API_URL}/api/posts/${id}`,\n        {\n          headers: { Authorization: user.token },\n        }\n      );\n      setPost(res.data);\n      setPostFile(res.data.image);\n      setMessage(res.data.message);\n    };\n    getPost();\n  }, [id, user]);\n\n  //Update post\n  const handleUpdate = async (e) => {\n    const newFile = file ? file : \"\";\n    e.preventDefault();\n    const formData = new FormData();\n    formData.append(\"userId\", user.currentUser.userId);\n    formData.append(\"image\", newFile);\n    formData.append(\"message\", message);\n\n    await axios.put(\n      `${process.env.REACT_APP_API_URL}/api/posts/${id}`,\n      formData,\n      {\n        headers: {\n          Authorization: user.token,\n        },\n      }\n    );\n    navigate(\"/\");\n  };\n\n  return (\n    <FormWrapper>\n      <ReturnIcon to=\"/\">\n        <BackspaceIcon style={{ scale: \"2\" }} />\n        Retour\n      </ReturnIcon>\n      <Title>Modifiez votre Post :</Title>\n      <PostFormContainer onSubmit={handleUpdate}>\n        {file && (\n          <>\n            <PostText>Nouvelle image</PostText>\n            <PostFormImgContainer>\n              <PostFileImg src={URL.createObjectURL(file)} alt=\"post_image\" />\n              <CancelImg\n                onClick={() => {\n                  setFile(\"\");\n                  setPostFile(postFile);\n                }}\n              />\n            </PostFormImgContainer>\n          </>\n        )}\n        <StyledHr />\n        {postFile ? (\n          <>\n            <PostText>Ancienne image</PostText>\n            <PostFormImgContainer>\n              <PostFileImg src={postFile} />\n            </PostFormImgContainer>\n          </>\n        ) : (\n          \"\"\n        )}\n        <Label htmlFor=\"file\">\n          Modifier image :\n          <PermMediaIcon htmlColor={`${colors.primary}`} />\n          <FileInput\n            type=\"file\"\n            id=\"file\"\n            accept=\".png,.jpg,.jpeg\"\n            onChange={(e) => setFile(e.target.files[0])}\n          />\n        </Label>\n        <Label htmlFor=\"message\">Modifier message :</Label>\n        <TextArea\n          name=\"message\"\n          value={message}\n          onChange={(e) => setMessage(e.target.value)}\n        ></TextArea>\n        <Button>VALIDER</Button>\n      </PostFormContainer>\n    </FormWrapper>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}